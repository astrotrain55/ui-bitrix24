{"version":3,"file":"BxInputFile.stories-7901366f.js","sources":["../../src/utils/formatSizeUnits.js","../../src/components/BxInputFile.vue"],"sourcesContent":["export function formatSizeUnits(countBytes) {\n  const dictionary = {\n    GB: 1073741824,\n    MB: 1048576,\n    KB: 1024,\n  };\n  const formatBytes = (key) => {\n    const count = (countBytes / dictionary[key]).toFixed(2);\n    return [count, key].join(' ');\n  };\n  let bytes = 0;\n\n  if (countBytes >= dictionary.GB) bytes = formatBytes('GB');\n  else if (countBytes >= dictionary.MB) bytes = formatBytes('MB');\n  else if (countBytes >= dictionary.KB) bytes = formatBytes('KB');\n  else bytes = [countBytes, 'B'].join(' ');\n\n  return bytes;\n}\n","<template>\n  <div class=\"drag-n-drop\">\n    <label\n      v-if=\"type === 'button'\"\n      class=\"ui-ctl ui-ctl-file-btn\"\n      :class=\"{ 'bx-input-file-disabled': disabled }\"\n      :title=\"title\"\n    >\n      <input\n        class=\"ui-ctl-element\"\n        type=\"file\"\n        :multiple=\"multiple\"\n        :disabled=\"disabled\"\n        @change=\"onChange\"\n      >\n      <div class=\"ui-ctl-label-text\">\n        {{ placeholder || defaultPlaceholder }}\n      </div>\n    </label>\n    <label\n      v-else-if=\"type === 'link'\"\n      class=\"ui-ctl ui-ctl-file-link\"\n      :class=\"{ 'bx-input-file-disabled': disabled }\"\n      :title=\"title\"\n    >\n      <input\n        class=\"ui-ctl-element\"\n        type=\"file\"\n        :multiple=\"multiple\"\n        :disabled=\"disabled\"\n        @change=\"onChange\"\n      >\n      <div class=\"ui-ctl-label-text\">\n        {{ placeholder || defaultPlaceholder }}\n      </div>\n    </label>\n    <label\n      v-else-if=\"type === 'drop'\"\n      class=\"ui-ctl ui-ctl-file-drop\"\n      :class=\"{ 'bx-input-file-disabled': disabled }\"\n      :title=\"title\"\n    >\n      <div class=\"ui-ctl-label-text\">\n        <span>{{ placeholder || defaultPlaceholder }}</span>\n        <small>Перетащить с помощью drag'n'drop</small>\n      </div>\n      <input\n        class=\"ui-ctl-element\"\n        type=\"file\"\n        :multiple=\"multiple\"\n        :disabled=\"disabled\"\n        @change=\"onChange\"\n      >\n    </label>\n    <ul v-if=\"files.length\" class=\"drag-n-drop__list\">\n      <li v-for=\"(file, key) in files\" :key=\"key\" class=\"drag-n-drop__file\">\n        <span class=\"drag-n-drop__name\">{{ getName(file) }}</span>\n        <span class=\"drag-n-drop__delete\" @click=\"onDelete(key)\"></span>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport { formatSizeUnits } from '../utils/formatSizeUnits';\nimport { loadStyles } from '../utils/loadStyles';\n\nexport const props = {\n  types: ['drop', 'button', 'link'],\n};\n\nexport default defineComponent({\n  methods: {\n    getName(file) {\n      return `${file.name} (${formatSizeUnits(file.size)})`;\n    },\n\n    onChange(e) {\n      this.files.push(...e.target.files);\n      this.$emit('change', [...this.files]);\n    },\n\n    onDelete(index) {\n      const [file] = this.files.splice(index, 1);\n      this.$emit('delete', [...this.files], file);\n    },\n  },\n  computed: {\n    title() {\n      if (this.disabled) return '';\n      if (this.files.length) return this.files.map((file) => file.name).join('\\n');\n      if (this.multiple) return 'Файлы не выбраны.';\n      return 'Файл не выбран.';\n    },\n  },\n  created() {\n    loadStyles();\n  },\n  data() {\n    return {\n      files: [],\n      defaultPlaceholder: 'Загрузить файл или картинку',\n    };\n  },\n  emits: ['change', 'delete'],\n  props: {\n    placeholder: {\n      type: String,\n      default: '',\n      validator(value) {\n        return typeof value === 'string';\n      },\n    },\n    type: {\n      type: String,\n      default: 'drop',\n      validator(value) {\n        return props.types.includes(value);\n      },\n    },\n    multiple: {\n      type: Boolean,\n      default: false,\n    },\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  name: 'bx-input-file',\n});\n</script>\n\n<style>\n.ui-ctl.bx-input-file-disabled.ui-ctl-file-drop,\n.ui-ctl.bx-input-file-disabled.ui-ctl-file-link .ui-ctl-label-text,\n.ui-ctl.bx-input-file-disabled.ui-ctl-file-btn .ui-ctl-label-text {\n  cursor: not-allowed;\n}\n.drag-n-drop .ui-ctl-file-drop .ui-ctl-element,\n.drag-n-drop .ui-ctl-file-link .ui-ctl-element,\n.drag-n-drop .ui-ctl-file-btn .ui-ctl-element {\n  display: block;\n  position: absolute;\n  top: -100%;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  opacity: 0;\n}\n.drag-n-drop {\n  width: 100%;\n  overflow: hidden;\n}\n.drag-n-drop__list {\n  list-style-type: none;\n  padding: 0;\n  margin: 5px 0 0;\n}\n.drag-n-drop__file {\n  display: flex;\n  align-items: center;\n}\n.drag-n-drop__name {\n  text-overflow: ellipsis;\n  overflow: hidden;\n  color: #2067b0;\n  font-size: 13px;\n  line-height: 1.8;\n}\n.drag-n-drop__delete {\n  background-image: url(\"../assets/wduf-sprite.png\");\n  background-repeat: no-repeat;\n  background-position: center -44px;\n  width: 24px;\n  height: 24px;\n  cursor: pointer;\n}\n</style>\n"],"names":["formatSizeUnits","countBytes","dictionary","formatBytes","key","bytes","props","_sfc_main","defineComponent","file","index","loadStyles","value","_hoisted_2","_hoisted_5","_hoisted_7","_hoisted_12","_sfc_render","_ctx","_cache","$props","$setup","$data","$options","_createElementBlock","_hoisted_1","_openBlock","_normalizeClass","_createElementVNode","args","_hoisted_3","_hoisted_4","_toDisplayString","_hoisted_6","_hoisted_9","_hoisted_10","_hoisted_8","_createCommentVNode","_Fragment","_renderList","_hoisted_13"],"mappings":"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"}